<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> حجز لمواعيد التنظيف </title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        table { width: 80%; margin: auto; border-collapse: collapse; }
        th, td { border: 1px solid black; padding: 10px; text-align: center; position: relative; }
        th { background-color: #5A9BD5; color: white; padding: 10px; }
        .input-box { width: 90%; padding: 5px; border: none; background: transparent; }
        .filled { background-color: #90EE90 !important; }
    </style>
</head>
<body>
    <h2>حجز مواعيد التنظيف </h2>
    <div class="nav-buttons">
        <button onclick="prevWeek()">الأسبوع السابق</button>
        <span id="week-range"></span>
        <button onclick="nextWeek()">الأسبوع التالي</button>
    </div>
    <table>
        <thead>
            <tr>
                <th>الوقت</th>
                <th id="day1"></th>
                <th id="day2"></th>
                <th id="day3"></th>
                <th id="day4"></th>
                <th id="day5"></th>
            </tr>
        </thead>
        <tbody id="schedule"></tbody>
    </table>

    <script>
        let currentDate = new Date();
        let weekOffset = 0;

        function updateWeek() {
            let startDate = new Date();
            startDate.setDate(currentDate.getDate() + (weekOffset * 7));
            let days = [];
            for (let i = 0; i < 5; i++) {
                let day = new Date(startDate);
                day.setDate(startDate.getDate() + i);
                days.push(day);
            }

            document.getElementById("week-range").textContent = `الأسبوع من ${days[0].toLocaleDateString("ar-EG")} إلى ${days[4].toLocaleDateString("ar-EG")}`;
            document.getElementById("day1").textContent = `الأحد ${days[0].toLocaleDateString("ar-EG")}`;
            document.getElementById("day2").textContent = `الاثنين ${days[1].toLocaleDateString("ar-EG")}`;
            document.getElementById("day3").textContent = `الثلاثاء ${days[2].toLocaleDateString("ar-EG")}`;
            document.getElementById("day4").textContent = `الأربعاء ${days[3].toLocaleDateString("ar-EG")}`;
            document.getElementById("day5").textContent = `الخميس ${days[4].toLocaleDateString("ar-EG")}`;

            generateSchedule();
        }

        function generateSchedule() {
            const times = [];
            for (let hour = 0; hour < 24; hour++) {
                let amPm = hour < 12 ? "AM" : "PM";
                let hourFormatted = hour % 12 === 0 ? 12 : hour % 12;
                times.push(`${hourFormatted}:00 ${amPm}`);
            }

            const scheduleTable = document.getElementById("schedule");
            scheduleTable.innerHTML = "";

            times.forEach((time, rowIndex) => {
                let row = document.createElement("tr");
                let timeCell = document.createElement("td");
                timeCell.textContent = time;
                timeCell.style.backgroundColor = "#5A9BD5";
                timeCell.style.color = "white";
                row.appendChild(timeCell);

                for (let colIndex = 0; colIndex < 5; colIndex++) {
                    let cell = document.createElement("td");
                    cell.style.position = "relative";

                    let fileInput = document.createElement("input");
                    fileInput.type = "text";
                    fileInput.placeholder = "رقم الملف";
                    fileInput.className = "input-box";

                    let nameInput = document.createElement("input");
                    nameInput.type = "text";
                    nameInput.placeholder = "الاسم";
                    nameInput.className = "input-box";

                    let noteInput = document.createElement("input");
                    noteInput.type = "text";
                    noteInput.placeholder = "ملاحظة";
                    noteInput.className = "input-box";

                    let key = `appointment-${weekOffset}-${rowIndex}-${colIndex}`;
                    fileInput.value = localStorage.getItem(key + "-file") || "";
                    nameInput.value = localStorage.getItem(key + "-name") || "";
                    noteInput.value = localStorage.getItem(key + "-note") || "";

                    function checkFilled() {
                        if (fileInput.value || nameInput.value || noteInput.value) {
                            cell.classList.add("filled");
                        } else {
                            cell.classList.remove("filled");
                        }
                    }

                    fileInput.addEventListener("input", () => { localStorage.setItem(key + "-file", fileInput.value); checkFilled(); });
                    nameInput.addEventListener("input", () => { localStorage.setItem(key + "-name", nameInput.value); checkFilled(); });
                    noteInput.addEventListener("input", () => { localStorage.setItem(key + "-note", noteInput.value); checkFilled(); });

                    checkFilled();

                    cell.appendChild(fileInput);
                    cell.appendChild(nameInput);
                    cell.appendChild(noteInput);
                    row.appendChild(cell);
                }

                scheduleTable.appendChild(row);
            });
        }

        function prevWeek() {
            weekOffset--;
            updateWeek();
        }

        function nextWeek() {
            weekOffset++;
            updateWeek();
        }

        updateWeek();
    </script>
</body>
</html>
